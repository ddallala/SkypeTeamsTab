<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license. -->
<!-- See LICENSE in the project root for license information -->

<!DOCTYPE html>
<html>
  <body>
    <form>
      URL to iFrame: <input type="text" name="url" /><br>
      Bing Maps: <input type="radio" name="maptype" value="bing" onclick="onClick()">
      <br>
      Google Maps: <input type="radio" name="maptype" value="google" onclick="onClick()">
      
      <button type="button" onclick="onClick('Hello world!')">Click Me!</button>
    </form>

    <script src="https://statics.teams.microsoft.com/sdk/v0.3/js/MicrosoftTeams.min.js"></script>

    <script type="text/javascript">
       /*global microsoftTeams*/
      microsoftTeams.initialize();
      microsoftTeams.settings.registerOnSaveHandler(function(saveEvent) {
        var radios = document.getElementsByName('maptype');
        var url = document.getElementsByName("url");
        alert(url)
        if (radios[0].checked) {
          microsoftTeams.settings.setSettings({
            contentUrl: "https://www.github.com",
            suggestedTabName: "Bing Map",
            websiteUrl: "https://www.bing.com/maps",
            removeUrl: "https://ddallala.github.io/SkypeTeamsTab/tabremove.html"
          });
        } else {
          microsoftTeams.settings.setSettings({
            contentUrl: "https://www.google.com/maps/embed",
            suggestedTabName: "Google Map",
            websiteUrl: "https://www.google.com/maps",
            removeUrl: "https://ddallala.github.io/SkypeTeamsTab/tabremove.html"
          });
        }
       // saveEvent.notifySuccess();
      }
);

      function onClick() {
        var url = document.getElementsByName("url");
        console.debug(url[0].value)
       microsoftTeams.settings.setValidityState(true);
      }
    </script>
  </body>
</html>